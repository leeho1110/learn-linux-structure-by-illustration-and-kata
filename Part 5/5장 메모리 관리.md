# 5장: 메모리 관리

### 개요

프로그램을 실행하기 위해선 필요한 것은 많습니다. 그 중 반드시 필요한 것은 CPU와 메모리입니다. 이번 장에서는 리눅스가 단순히 물리적 메모리가 갖고 있는 한계를 어떤 기술들을 통해 극복했는지 알아봅니다.

---

### 메모리의 통계 정보

- 리눅스에선 사용중인 메모리의 여러 정보들을 `free` 명령어를 통해 확인할 수 있습니다. KB단위로 표기되며 아래는 확인할 수 있는 메모리 정보의 종류입니다.
    1. **total**: 시스템에 탑재된 전체 메모리의 용량을 의미합니다. 
    2. **free**: 표기상(중요) 이용하지 않는 메모리의 용량입니다.
    3. **buff/cache**: 버퍼 캐시 혹은 페이지 캐시가 이용하는 메모리입니다. free 필드에 표기되는 사용 가능한 메모리가 없을 때 커널이 추가 할당을 위해 해제하는 영역입니다.
    4. **available**: free 필드에서 이용하지 않는 메모리라는 표현을 사용했습니다. buff/cache 필드는 커널이 확장을 위해 해제 가능한 영역이었습니다. 이 둘을 합치면 최대로 사용 가능한 메모리 영역의 크기가 도출됩니다. availbale은 free 메모리에 부족할 때 해제되는 메모리 영역 사이즈까지 더한 크기입니다.

---

### 메모리의 부족과 OOM Killer

- 만약 정말 사용할 메모리가 없다면 메모리는 Out Of Memory, 일명 OOM 상태가 됩니다. 이 때 리눅스의 메모리 관리 시스템은 적절한 프로세스를 선택해 kill 해버립니다.
    - OOM Killer와 관련된 이슈들은 정말 많습니다. 그 중 서버 애플리케이션의 경우 대부분 자바 프로세스가 kill 되게 되는데요. 그 시간동안 해당 서버가 서비스를 운용하지 못하기 때문에 장애로 이어질 수 있습니다. 아래는 OOM Killer가 발생했을 때 Java Native Memory Leak에 대해 토스에서 공개한 세션입니다.
    - [토스ㅣSLASH 22 - Java Native Memory Leak 원인을 찾아서](https://www.youtube.com/watch?v=w4fWgLgop5U)

---